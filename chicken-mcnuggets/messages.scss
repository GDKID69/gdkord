// ╭┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈ >> >
// ┃ Embeds & Messages
// ╰───────────────────────────────────────────────────────── >> >

// <-- Keyframe animations --> //
@keyframes embedHover {
    from { background: hsla(0, 0%, 5%);}
    to { background: hsla(0, 0%, 2%)}
}

@keyframes messageHover {
    from { background: transparent;}
    to { background: var(--background-message-hover);}
}

@keyframes messageUnhover {
    from { background: var(--background-message-hover);}
    to { background: transparent;}
}

@keyframes flash {
    from { background: hsla(var(--awesome-colour-alt), 0.3);}
    to { background: transparent !important;}
}

// <-- Embeds --> //
[class*=spoilerContainer-] [class*=embedFull-][class*=hiddenSpoiler-] {
    border-left: 4px solid transparent;
    & > [class*=grid-] { margin-left: 0;}
    &::before { display: none;}
}

[class*=embedFull-] {
    border-color: var(--background-secondary);
    box-shadow: 0 0 6px black;
    filter: drop-shadow(0 0 var(--default-drop-shadow) black);
    transition: .2s ease-in-out;
    border-width: 100px;

    &::before {
        content: "";
        left: -100px;
        width: 100px;
        height: 100%;
        position: absolute;
        background: linear-gradient(
            to right,
            transparent 3.9%,
            hsla(var(--background-secondary-raw), 0.75) 4%,
            hsla(var(--background-secondary-raw), 0.875) 50%,
            var(--background-secondary) 100%
        );
    }

    &:hover {
        transform: translateX(5px);
        border-color: transparent !important;
    }

    [class*=grid-]:first-child {
        margin-left: -97px;
        z-index: 1;
    }
}

// <-- Messages --> //
li[class*=messageListItem-] {
    & > [class*=message-] {
        animation-name: messageUnhover;
        animation-duration: 0.35s;
        background: transparent;

        &:hover {
            animation-name: messageHover;
            animation-duration: 0.35s;
            background: var(--background-message-hover);

            [class*=buttons] {
                opacity: 1;
                pointer-events: auto;
            }
        }

        // <-- Thread Embed Side Line --> //
        &[class*=hasThread-]::after {
            border-left-color: hsla(0, 0%, 100%, 0.25);
            border-bottom-color: hsla(0, 0%, 100%, 0.25);
        }

        // <-- Replied Message Side Line --> //
        & > [class*=repliedMessage-]::before {
            border-left-color: hsla(0, 0%, 100%, 0.25);
            border-top-color: hsla(0, 0%, 100%, 0.25);
        }

        // <-- Ephemeral Messages & Replying --> //
        &[class*=replying-],
        &[class*=ephemeral-],
        &[class*=replying-][class*=mentioned-] {
            background: linear-gradient(to right, hsla(var(--awesome-colour-alt), 0.05) 80%, transparent) !important;
            border-radius: 10px;

            &::before { background: hsla(var(--awesome-colour-alt)) !important;}
        }

        // <-- Mentioned Messages --> //
        &[class*=mentioned-] {
            background: linear-gradient(to right, var(--background-mentioned) 80%, transparent) !important;
        }

        // <-- Buttons --> //
        [id*=message-accessories-] [class*=container-] { overflow: visible;}

        // <-- Invite Cards --> //
        [id*=message-accessories-] > [class*=wrapper-][class*=userSelectNone-] {
            transition: .2s ease-in-out;
            &:hover {
                transform: translateX(5px);
                background: var(--background-tertiary) !important;
                filter: none !important;
            }

            & > [class*=content-] > [class*=guildIcon-]::before {
                content: "";
                border: 1px solid hsla(var(--invite-border-colour), 0.75);
                filter: drop-shadow(0 0 calc(var(--default-drop-shadow) - 3px) hsla(var(--invite-border-colour)));
                box-shadow: 0 0 2px hsla(var(--invite-border-colour));
                position: absolute;
                border-radius: 5px;
                height: 108px;
                width: 431px;
            }

            &[class*=clickable-] {
                --invite-border-colour: 227, 58%, 65%;
                border: 1px solid hsla(var(--invite-border-colour), 0.75);
                filter: drop-shadow(0 0 calc(var(--default-drop-shadow) - 3px) hsla(var(--invite-border-colour), 0.75)) !important;
                box-shadow: inset 0 0 2px hsla(var(--invite-border-colour));
            }

            [class*=guildIcon-]:not([class*=guildIconExpired-])::before {
                --invite-border-colour: var(--green);
                left: -16px;
                top: -44px;
            }

            [class*=guildIconExpired-]::before {
                --invite-border-colour: var(--ping-red);
                left: 0px;
                margin-top: -45px;
            }
        }
    }

    // <-- Message Jump Flash --> //
    & + [class*=backgroundFlash-] {
        animation-name: flash;
        animation-duration: 2s;
        animation-iteration-count: 1;
    }

    // <-- Media Hover Effect --> //
    a[class*=embedMedia-],
    [class*=clickableSticker-],
    [class*=messageAttachment-] > [class*=imageWrapper-],
    [class*=messageAttachment-] > a {
        transition: .2s ease-in-out;

        &:hover {
            transform: var(--media-hover);
        }
    }
}

// <-- Codeblocks --> //
[class*=markup-] code:not(.inline) {
    background: hsla(0, 0%, 2%);
    border: 2px solid hsla(0, 0%, 2%);
    overflow: auto;
    white-space: pre;

    & > .powercord-codeblock-lang {
        position: sticky;
        left: 0;
    }

    & > button {
        position: sticky;
        opacity: 1 !important;
        top: 0;
        left: 0;
        padding: 0 6px;
        width: 100%;
        bottom: unset !important;
        line-height: 15px;
        border-radius: 4px;
    }
}
